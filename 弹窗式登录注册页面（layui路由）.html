<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./layui/css/layui.css" />
    <script src="./js/jquery-3.5.1.min.js"></script>
    <script src="./layui/layui.js"></script>
    <style>
      /* register */
      .content-wrapper {
        width: 100%;
        height: 100%;
        /* 弹性布局 */
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .card {
        border-radius: 20px;
      }
      .my-input-block {
        float: left;
        margin-left: 8px;
      }

      /* login */
      .login-body {
        background: url("../images/时钟.png") repeat fixed;
      }
      .login-box {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        margin: auto;
        width: 320px;
        height: 241px;
        max-height: 300px;
      }

      .login-body .login-box h3 {
        color: #444;
        font-size: 22px;
        font-weight: 100;
        text-align: center;
      }

      .login-box .layui-input[type="number"] {
        display: inline-block;
        width: 50%;
        vertical-align: top;
      }

      .login-box img {
        display: inline-block;
        width: 46%;
        height: 38px;
        border: none;
        vertical-align: top;
        cursor: pointer;
        margin-left: 4%;
      }

      .login-box button.btn-reset {
        width: 95px;
      }

      .login-box button.btn-submit {
        width: 190px;
      }

      .login-main {
        width: 90%;
        height: 100%;
        /* 弹性布局 */
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        margin: 0 auto;
      }

      .login-main .header {
        margin-top: 10px;
        height: 40px;
        line-height: 40px;
        font-size: 30px;
        font-weight: 400;
        text-align: center;
      }

      .login-main .header,
      .login-main form,
      .login-main form .layui-input-inline {
        margin-bottom: 15px;
      }

      .login-main form .layui-input-inline,
      .login-main form .layui-input-inline input,
      .login-main form .layui-input-inline button {
        width: 100%;
      }

      .login-main form .login-btn {
        margin-bottom: 5px;
      }
      .fL {
        float: left;
      }
    </style>
  </head>
  <body>
    <!-- -----------------------------------------个人中心 ------------------------------------------->
    <ul class="layui-nav layui-bg-blue" style="z-index: 999">
      <li class="layui-nav-item"><a href="../index.html">首页</a></li>
      <!-- layui-this 这个属性指默认选择项，添加上就是设置其为默认选择项 -->

      <li class="layui-nav-item">
        <!-- 锚点定位 -->
        <a href="#qa">QA</a>
      </li>

      <li class="layui-nav-item">
        <a href="#events">赛项介绍</a>
      </li>

      <li class="layui-nav-item">
        <a href="#news">新闻资讯</a>
        <dl class="layui-nav-child adminShow">
          <dd>
            <a href="/fjaisc/html/informationManager.html">资讯管理</a>
          </dd>
          <dd style="display: none">
            <a href="/fjaisc/html/newsEditing.html">资讯编辑</a>
          </dd>
        </dl>
      </li>

      <li class="layui-nav-item">
        <a href="#cooperation">合作链接</a>
      </li>

      <div style="float: right">
        <li class="layui-nav-item" lay-unselect="">
          <a href="javascript:;">个人中心</a>
          <dl class="layui-nav-child">
            <dd class="commonShow">
              <a id="login" href="javascript:;" onclick="login()">登录</a>
            </dd>
            <dd class="commonShow">
              <!-- 给a标签href加上javascript:;可以避免像#那样抖动，因为是执行一个空的js语句 -->
              <a id="register" href="javascript:;" onclick="register()">注册</a>
            </dd>
            <!-- <dd class="loginShow" style="display: none">
              <a href="javascript:location.href='/fjaisc/html/updateMyself.html';"
                >个人信息</a
              >
            </dd>
            <dd class="loginShow" style="display: none">
              <a
                href="javascript:location.href='/fjaisc/html/changePassword.html';"
                >修改密码</a
              >
            </dd> -->

            <dd class="loginShow" style="display: none">
              <a href="javascript:location.href='/fjaisc/logout';">退出登录</a>
            </dd>
          </dl>
        </li>
      </div>
    </ul>

    <script>
      /* 前端路由
      
      // 截取url的参数 方法一：
      function getQuery() {
        const url = decodeURI(location.search); // 获取url中"?"符后的字串(包括问号)
        let query = {};
        if (url.indexOf("?") != -1) {
          // 判断是否带请求参数
          const str = url.substr(1); // 去除url中的?
          const pairs = str.split("&"); // 以&分割各个参数
          for (let i = 0; i < pairs.length; i++) {
            const pair = pairs[i].split("="); // 以 = 分割 key和 value
            query[pair[0]] = pair[1];
          }
        }
        return query; // 返回请求参数对象
      }

      var query = getQuery();
      data: {
        infoId: query.infoId;
      }

      // <!-- !方法二： layui的前端路由接收参数 -->
      // //前一个页面的跳转链接： href="./html/informationNew.html?/#/infoId=1"   ?/#/infoId=1 先写? 再写/#/，不然无法跳转页面
      // var router = layui.router();
      // layui.router()会获取所有的拼接数据，通过.search.拼接数据名称就能找到
      // // 这个infoId就是链接拼接的传参
      // console.log(router.search.infoId);


     */
    </script>

    <!-- 把导航栏的js放在header.html里，否则会触发bug，导致导航栏无法点击 -->
    <script>
      // 导航栏的jquery
      //注意：导航栏 依赖 element 模块，否则无法进行功能性操作
      layui.use(["element", "layedit", "form", "layer"], function () {
        var element = layui.element; //导航的hover效果、二级菜单等功能，需要依赖element模块
        var $ = layui.jquery;
      });

      // 注册弹窗
      function register() {
        layui.use(["laydate", "layedit", "form", "layer"], function () {
          var layer = layui.layer,
            laydate = layui.laydate,
            form = layui.form;

          //关闭所有已经弹出的页面层
          // 这样会先关闭登录页面的弹出层,在打开注册页面的弹出层
          layer.closeAll("page");

          laydate.render({
            elem: "#birthday",
          });
          layer.open({
            type: 1,
            title:
              '<i class="layui-icon layui-icon-survey" style="font-size: 18px; color: #1E9FFF;"><b>register</b> </i>',
            area: ["450px", "550px"],
            btn: ["提交", "取消"],
            btnAlign: "r",

            content:
              '<div class="content-wrapper">\n' +
              '      <div class="layui-card card">\n' +
              '          <div class="layui-card-header" style="text-align: center; font-size: 20px">注册一个新账户</div>\n' +
              '          <div class="layui-card-body" style="width: 400px">\n' +
              '              <form class="layui-form">\n' +
              '              <div class="layui-form-item">\n' +
              '                  <label class="layui-form-label" style="width: 90px; margin-left: 20px;">用户名</label>\n' +
              '                  <div class="layui-input-block my-input-block">\n' +
              '                      <input type="text" name="username" lay-verify="required" autocomplete="off" class="layui-input" placeholder="用户名">\n' +
              "                  </div>\n" +
              "              </div>\n" +
              '              <div class="layui-form-item">\n' +
              '                  <label class="layui-form-label" style="width: 90px; margin-left: 20px;">密码</label>\n' +
              '                  <div class="layui-input-block my-input-block">\n' +
              '                      <input type="password" name="password" lay-verify="required" autocomplete="off" class="layui-input" placeholder="请输入密码">\n' +
              "                  </div>\n" +
              "              </div>\n" +
              '              <div class="layui-form-item">\n' +
              '                  <label class="layui-form-label" style="width: 90px; margin-left: 20px;">昵称</label>\n' +
              '                  <div class="layui-input-block my-input-block">\n' +
              '                      <input type="text" name="nickname" lay-verify="required" autocomplete="off" class="layui-input" placeholder="请输入昵称">\n' +
              "                  </div>\n" +
              "              </div>\n" +
              '              <div class="layui-form-item">\n' +
              '                  <label class="layui-form-label" style="width: 90px; margin-left: 20px;">手机号</label>\n' +
              '                  <div class="layui-input-block my-input-block">\n' +
              '                      <input type="tel" name="phone" lay-verify="required|phone" autocomplete="off" class="layui-input" placeholder="请输入手机号码">\n' +
              "                  </div>\n" +
              "              </div>\n" +
              "\n" +
              '              <div class="layui-form-item">\n' +
              '                  <label class="layui-form-label" style="width: 90px; margin-left: 20px;">邮箱</label>\n' +
              '                  <div class="layui-input-block my-input-block">\n' +
              '                      <input type="email" name="email" lay-verify="required|email" autocomplete="off" class="layui-input" placeholder="请输入邮箱">\n' +
              "                  </div>\n" +
              "              </div>\n" +
              '              <div class="layui-form-item">\n' +
              '                  <label class="layui-form-label" style="width: 90px; margin-left: 20px;">生日</label>\n' +
              '                  <div class="layui-input-block my-input-block">\n' +
              '                      <input type="text" name="birthday" id="birthday" lay-verify="date" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input">\n' +
              "                  </div>\n" +
              "              </div>\n" +
              '              <div class="layui-form-item">\n' +
              '                  <label class="layui-form-label" style="width: 90px; margin-left: 20px;">性别</label>\n' +
              '                  <div class="layui-input-block my-input-block">\n' +
              '                      <input type="radio" name="sex" value="1" title="男" checked="">\n' +
              '                      <input type="radio" name="sex" value="0" title="女">\n' +
              "                  </div>\n" +
              "              </div>\n" +
              "              </form>\n" +
              "          </div>\n" +
              "      </div>\n" +
              "  </div>",

            yes: function (index, layero) {
              // 表单提交
              form.on("submit(formDemo)", function (data) {
                var btn = $(this);
                //设置注册按钮为不可点击
                btn
                  .text("注册中...")
                  .attr("disabled", "disabled")
                  .addClass("layui-disabled");
                $.ajax({
                  type: "post",
                  // 接口
                  url: "../json/register.json",
                  //服务器返回的数据类型
                  dataType: "json",
                  //发送到服务器的数据，对象必须为key/value的格式，jquery会自动转换为字符串格式
                  data: JSON.stringify(data.field),
                  success: function (data) {
                    layer.msg(
                      "注册成功",
                      {
                        icon: 1,
                        time: 2000, //2秒后执行关闭弹窗操作
                      },
                      function () {
                        // 关闭弹窗
                        layer.close(index);
                      }
                    );
                  },
                  error: function () {
                    //请求失败函数内容
                    layer.msg("提交失败", {
                      icon: 2,
                      time: 2000,
                    });
                  },
                });
              });
            },
            btn2: function (index, layero) {
              // 关闭弹窗
              layer.close(index);
              //return false 开启该代码可禁止点击该按钮关闭
            },
            closeBtn: 2,
            // 右上角的叉叉按钮样式 0-2
            // 两种风格的关闭按钮，可通过配置1和2来展示，如果不显示，则closeBtn: 0

            shade: [0.8, "#393D49"],

            success: function (layero, index) {
              //因为不通过form里的按钮进行提交，所以必须进行设置，将弹出层的按钮转换成表单的提交按钮
              layero.addClass("layui-form");
              // 将确认按钮改变成提交按钮
              layero.find(".layui-layer-btn0").attr({
                "lay-filter": "formDemo",
                "lay-submit": "",
              });
              // 重载表单，否则无法应用
              form.render();
            },
          });
        });
      }

      // 登录弹窗
      function login() {
        layui.use(["form", "layer"], function () {
          var layer = layui.layer,
            form = layui.form;

          layer.open({
            type: 1,
            title:
              '<i class="layui-icon layui-icon-survey" style="font-size: 18px; color: #1E9FFF;"><b>login</b> </i>',
            area: ["450px", "400px"],
            // btn: ["提交", "取消"],
            // btnAlign: "r",

            content:
              '<div class="login-main">\n' +
              '      <div class="header" >登录</div>\n' +
              '      <form class="layui-form">\n' +
              '        <div class="layui-input-inline">\n' +
              "          <input\n" +
              '            type="text"\n' +
              '            name="account"\n' +
              "            required\n" +
              '            lay-verify="required"\n' +
              '            placeholder="用户名"\n' +
              '            autocomplete="off"\n' +
              '            class="layui-input"\n' +
              "          />\n" +
              "        </div>\n" +
              '        <div class="layui-input-inline">\n' +
              "          <input\n" +
              '            type="password"\n' +
              '            name="password"\n' +
              "            required\n" +
              '            lay-verify="required"\n' +
              '            placeholder="密码"\n' +
              '            autocomplete="off"\n' +
              '            class="layui-input"\n' +
              "          />\n" +
              "        </div>\n" +
              '        <div class="layui-input-inline login-btn">\n' +
              '          <button lay-submit lay-filter="login" class="layui-btn">登录</button>\n' +
              "        </div>\n" +
              "        <hr />\n" +
              "\n" +
              "        <p>\n" +
              '          <a href="javascript:;" onclick="register() " class="fL">立即注册</a>\n' +
              "        </p>\n" +
              "      </form>\n" +
              "    </div>",

            closeBtn: 2,
            // 右上角的叉叉按钮样式 0-2
            // 两种风格的关闭按钮，可通过配置1和2来展示，如果不显示，则closeBtn: 0

            shade: [0.8, "#393D49"],

            success: function (layero, index) {
              // 重载表单，否则无法应用
              form.render();
            },
          });

          // 表单提交
          form.on("submit(login)", function (data) {
            var btn = $(this);
            //设置登录按钮  为不可点击
            btn
              .text("登录中...")
              .attr("disabled", "disabled")
              .addClass("layui-disabled");
            $.ajax({
              type: "post",
              // 接口
              url: "../json/register.json",
              //服务器返回的数据类型
              dataType: "json",
              //发送到服务器的数据，对象必须为key/value的格式，jquery会自动转换为字符串格式
              data: JSON.stringify(data.field),
              success: function (data) {
                layer.msg(
                  "登录成功",
                  {
                    icon: 1,
                    time: 2000, //2秒后执行关闭弹窗操作
                  },
                  function () {
                    // 关闭弹窗
                    layer.close(index);
                  }
                );
              },
              error: function () {
                //请求失败函数内容
                layer.msg("登录失败", {
                  icon: 2,
                  time: 2000,
                });
              },
            });
          });
        });
      }
    </script>
  </body>
</html>
